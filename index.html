<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Lessons</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Vue.js v2 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <header>
      <h1 v-text="sitename"></h1>
    </header>

    <main class="container">
      <div class="controls">
        <div class="controls-left">
          <div class="controls-row">
            <div class="sort-label">Sort By:</div>
            <div class="radio-group">
              <label><input type="radio" v-model="sortKey" value="subject" /> Subject</label>
              <label><input type="radio" v-model="sortKey" value="location" /> Location</label>
              <label><input type="radio" v-model="sortKey" value="price" /> Price</label>
            </div>
          </div>

          <div class="controls-row">
            <div class="order-label">Order:</div>
            <div class="radio-group">
              <label><input type="radio" v-model="sortDir" value="asc" /> Ascending</label>
              <label><input type="radio" v-model="sortDir" value="desc" /> Descending</label>
          </div>
        </div>
      </div>  

      <div class="total-lessons">Total Lessons: {{ lessons.length }}</div>
      </div>
      <!--Displaying multiple lessons -->  
      <section class="lessons">  
        <article class="card" v-for="lesson in lessons" :key="lesson.id">  
          <h2>{{ lesson.subject }}</h2>  
          <div>Location: {{ lesson.location }}</div>  
          <div>Price: Â£{{ lesson.price }}</div>  
          <div>Spaces: {{ lesson.spaces }}</div>  
        </article>  
      </section>  
    </main>  
  </div>

  <script src="lessons.js"></script>

  <script>
    var webstore = new Vue ({
      el: '#app',
      data: {
        sitename: 'Lessons',
        lessons: (typeof lessons !== 'undefined') ? lessons : [],
        sortKey: 'subject',
        sortDir: 'asc'
      },
      created() {  
        //Checks if the lessons data is loaded  
        if (typeof lessons !== 'undefined' && Array.isArray(lessons) && lessons.length) {  
          this.lessons = lessons;  
        } else {  
          console.warn('lessons.js not found or empty');  
        }  
      },
      computed: {
        //Sorts the lessons based on the key and direction
        sortedLessons() {
          const arr = this.lessons.slice();
          const key = this.sortKey;
          const dir = this.sortDir === 'asc' ? 1 : -1;
          arr.sort((a,b) =>  {
            let va = a[key];  
            let vb = b[key];  
            if (typeof va === 'string') va = va.toLowerCase();  
            if (typeof vb === 'string') vb = vb.toLowerCase();  
            if (va > vb) return 1 * dir;  
            if (va < vb) return -1 * dir;  
            return 0;
          });
          return arr;
        }
      }
    });
  </script>
</body>
</html>